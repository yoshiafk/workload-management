/**
 * Indonesian Public Holidays 2025-2026
 * Pre-loaded data from Excel prototype
 */

export const indonesiaHolidays2025 = [
    { id: 'hd_2025_001', date: '2025-01-01', name: "Tahun Baru 2025 Masehi", type: 'national', year: 2025 },
    { id: 'hd_2025_002', date: '2025-01-27', name: 'Isra Mikraj Nabi Muhammad SAW', type: 'national', year: 2025 },
    { id: 'hd_2025_003', date: '2025-01-29', name: 'Tahun Baru Imlek 2576 Kongzili', type: 'national', year: 2025 },
    { id: 'hd_2025_004', date: '2025-03-29', name: 'Hari Suci Nyepi (Tahun Baru Saka 1947)', type: 'national', year: 2025 },
    { id: 'hd_2025_005', date: '2025-03-31', name: 'Hari Raya Idul Fitri 1446 Hijriah', type: 'national', year: 2025 },
    { id: 'hd_2025_006', date: '2025-04-01', name: 'Hari Raya Idul Fitri 1446 Hijriah', type: 'national', year: 2025 },
    { id: 'hd_2025_007', date: '2025-04-18', name: 'Wafat Yesus Kristus', type: 'national', year: 2025 },
    { id: 'hd_2025_008', date: '2025-04-20', name: 'Kebangkitan Yesus Kristus (Paskah)', type: 'national', year: 2025 },
    { id: 'hd_2025_009', date: '2025-05-01', name: 'Hari Buruh Internasional', type: 'national', year: 2025 },
    { id: 'hd_2025_010', date: '2025-05-12', name: 'Hari Raya Waisak 2569 BE', type: 'national', year: 2025 },
    { id: 'hd_2025_011', date: '2025-05-29', name: 'Kenaikan Yesus Kristus', type: 'national', year: 2025 },
    { id: 'hd_2025_012', date: '2025-06-01', name: 'Hari Lahir Pancasila', type: 'national', year: 2025 },
    { id: 'hd_2025_013', date: '2025-06-06', name: 'Hari Raya Idul Adha 1446 Hijriah', type: 'national', year: 2025 },
    { id: 'hd_2025_014', date: '2025-06-27', name: '1 Muharam Tahun Baru Islam 1447 Hijriah', type: 'national', year: 2025 },
    { id: 'hd_2025_015', date: '2025-08-17', name: 'Hari Kemerdekaan RI', type: 'national', year: 2025 },
    { id: 'hd_2025_016', date: '2025-09-05', name: "Maulid Nabi Muhammad SAW", type: 'national', year: 2025 },
    { id: 'hd_2025_017', date: '2025-12-25', name: 'Hari Raya Natal', type: 'national', year: 2025 },
];

export const indonesiaHolidays2026 = [
    { id: 'hd_2026_001', date: '2026-01-01', name: "Tahun Baru 2026 Masehi", type: 'national', year: 2026 },
    { id: 'hd_2026_002', date: '2026-01-16', name: 'Isra Mikraj Nabi Muhammad SAW', type: 'national', year: 2026 },
    { id: 'hd_2026_003', date: '2026-02-17', name: 'Tahun Baru Imlek 2577 Kongzili', type: 'national', year: 2026 },
    { id: 'hd_2026_004', date: '2026-03-19', name: 'Hari Suci Nyepi (Tahun Baru Saka 1948)', type: 'national', year: 2026 },
    { id: 'hd_2026_005', date: '2026-03-21', name: 'Hari Raya Idul Fitri 1447 Hijriah', type: 'national', year: 2026 },
    { id: 'hd_2026_006', date: '2026-03-22', name: 'Hari Raya Idul Fitri 1447 Hijriah', type: 'national', year: 2026 },
    { id: 'hd_2026_007', date: '2026-04-03', name: 'Wafat Yesus Kristus', type: 'national', year: 2026 },
    { id: 'hd_2026_008', date: '2026-04-05', name: 'Kebangkitan Yesus Kristus (Paskah)', type: 'national', year: 2026 },
    { id: 'hd_2026_009', date: '2026-05-01', name: 'Hari Buruh Internasional', type: 'national', year: 2026 },
    { id: 'hd_2026_010', date: '2026-05-14', name: 'Kenaikan Yesus Kristus', type: 'national', year: 2026 },
    { id: 'hd_2026_011', date: '2026-05-27', name: 'Hari Raya Idul Adha 1447 Hijriah', type: 'national', year: 2026 },
    { id: 'hd_2026_012', date: '2026-05-31', name: 'Hari Raya Waisak 2570 BE', type: 'national', year: 2026 },
    { id: 'hd_2026_013', date: '2026-06-01', name: 'Hari Lahir Pancasila', type: 'national', year: 2026 },
    { id: 'hd_2026_014', date: '2026-06-17', name: 'Tahun Baru Islam 1448 Hijriah', type: 'national', year: 2026 },
    { id: 'hd_2026_015', date: '2026-08-17', name: 'Hari Kemerdekaan RI', type: 'national', year: 2026 },
    { id: 'hd_2026_016', date: '2026-08-26', name: "Maulid Nabi Muhammad SAW", type: 'national', year: 2026 },
    { id: 'hd_2026_017', date: '2026-12-25', name: 'Hari Raya Natal', type: 'national', year: 2026 },
];

export const defaultHolidays = [...indonesiaHolidays2025, ...indonesiaHolidays2026];

// ============================================================================
// CUTI BERSAMA (COLLECTIVE LEAVE)
// Government-mandated collective leave days, separate from national holidays
// ============================================================================

export const cutiBersama2025 = [
    { id: 'cb_2025_001', date: '2025-01-28', name: 'Cuti Bersama Tahun Baru Imlek', type: 'collective', year: 2025 },
    { id: 'cb_2025_002', date: '2025-03-28', name: 'Cuti Bersama Hari Suci Nyepi', type: 'collective', year: 2025 },
    { id: 'cb_2025_003', date: '2025-04-02', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2025 },
    { id: 'cb_2025_004', date: '2025-04-03', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2025 },
    { id: 'cb_2025_005', date: '2025-04-04', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2025 },
    { id: 'cb_2025_006', date: '2025-04-07', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2025 },
    { id: 'cb_2025_007', date: '2025-05-13', name: 'Cuti Bersama Hari Raya Waisak', type: 'collective', year: 2025 },
    { id: 'cb_2025_008', date: '2025-06-02', name: 'Cuti Bersama Hari Lahir Pancasila', type: 'collective', year: 2025 },
    { id: 'cb_2025_009', date: '2025-06-16', name: 'Cuti Bersama Idul Adha', type: 'collective', year: 2025 },
    { id: 'cb_2025_010', date: '2025-12-26', name: 'Cuti Bersama Hari Raya Natal', type: 'collective', year: 2025 },
];

export const cutiBersama2026 = [
    { id: 'cb_2026_001', date: '2026-02-16', name: 'Cuti Bersama Tahun Baru Imlek', type: 'collective', year: 2026 },
    { id: 'cb_2026_002', date: '2026-03-18', name: 'Cuti Bersama Hari Suci Nyepi', type: 'collective', year: 2026 },
    { id: 'cb_2026_003', date: '2026-03-20', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2026 },
    { id: 'cb_2026_004', date: '2026-03-23', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2026 },
    { id: 'cb_2026_005', date: '2026-03-24', name: 'Cuti Bersama Idul Fitri', type: 'collective', year: 2026 },
    { id: 'cb_2026_006', date: '2026-05-15', name: 'Cuti Bersama Kenaikan Yesus Kristus', type: 'collective', year: 2026 },
    { id: 'cb_2026_007', date: '2026-05-28', name: 'Cuti Bersama Idul Adha', type: 'collective', year: 2026 },
    { id: 'cb_2026_008', date: '2026-12-24', name: 'Cuti Bersama Hari Raya Natal', type: 'collective', year: 2026 },
];

export const defaultCutiBersama = [...cutiBersama2025, ...cutiBersama2026];

/**
 * Merge national holidays with collective leave (cuti bersama)
 * 
 * @param {Array} holidays - National holiday dates
 * @param {Array} cutiBersama - Collective leave dates
 * @param {boolean} includeCollective - Whether to include cuti bersama (default: true)
 * @returns {Array} Combined and sorted array of all non-working days
 */
export function getMergedHolidays(holidays = defaultHolidays, cutiBersama = defaultCutiBersama, includeCollective = true) {
    if (!includeCollective) {
        return holidays;
    }

    const merged = [...holidays, ...cutiBersama];

    // Sort by date
    return merged.sort((a, b) => new Date(a.date) - new Date(b.date));
}

/**
 * Get holidays and cuti bersama for a specific year
 * 
 * @param {number} year - Year to filter
 * @param {boolean} includeCollective - Whether to include cuti bersama
 * @returns {Array} Holidays and optionally cuti bersama for the year
 */
export function getHolidaysByYear(year, includeCollective = true) {
    const yearHolidays = defaultHolidays.filter(h => h.year === year);

    if (!includeCollective) {
        return yearHolidays;
    }

    const yearCutiBersama = defaultCutiBersama.filter(c => c.year === year);
    return [...yearHolidays, ...yearCutiBersama].sort((a, b) => new Date(a.date) - new Date(b.date));
}

/**
 * Get count of working days in a month, accounting for holidays and cuti bersama
 * 
 * @param {number} year - Year
 * @param {number} month - Month (1-12)
 * @param {boolean} includeCollective - Whether to include cuti bersama
 * @returns {Object} Working days information for the month
 */
export function getMonthlyWorkingDays(year, month, includeCollective = true) {
    const startDate = new Date(year, month - 1, 1);
    const endDate = new Date(year, month, 0); // Last day of month
    const totalDays = endDate.getDate();

    // Count weekends
    let weekends = 0;
    for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
        const dayOfWeek = d.getDay();
        if (dayOfWeek === 0 || dayOfWeek === 6) {
            weekends++;
        }
    }

    // Get holidays for this month
    const monthStart = `${year}-${String(month).padStart(2, '0')}-01`;
    const monthEnd = `${year}-${String(month).padStart(2, '0')}-${String(totalDays).padStart(2, '0')}`;

    const allHolidays = getMergedHolidays(defaultHolidays, defaultCutiBersama, includeCollective);
    const monthHolidays = allHolidays.filter(h => h.date >= monthStart && h.date <= monthEnd);

    // Count holidays that fall on weekdays only
    const weekdayHolidays = monthHolidays.filter(h => {
        const date = new Date(h.date);
        const dayOfWeek = date.getDay();
        return dayOfWeek !== 0 && dayOfWeek !== 6;
    });

    const workingDays = totalDays - weekends - weekdayHolidays.length;

    return {
        year,
        month,
        totalDays,
        weekends,
        holidays: monthHolidays.length,
        weekdayHolidays: weekdayHolidays.length,
        workingDays,
        holidayList: monthHolidays
    };
}
